Релиз у нас в кармане
=====================

Существуют по крайней мере три подхода к поставке и последующему
сопровождению программного обеспечения[^1]. Первый подход --- поставка
*как есть*. Набор программ обыкновенно собирается в той же среде, в
которой ведётся вся разработка. Затем результат сборки устанавливается
на целевую систему вручную. Вручную же производится и настройка. Этот
подход оправдан лишь в самых тривиальных случаях, требует больших
трудозатрат для воспроизведения и ещё больших --- для обновлении
системы. Следующий уровень --- поставка в виде *пакетов*. Благодаря
использованию диспетчера пакетов этот вариант избавляет практически от
всех проблем предыдущего. Но, вместе с тем, создаёт новые. Например,
из-за сравнительной простоты установки и удаления отдельных пакетов,
целевая система может случайно быть приведена в состояние, отличное от
ожидаемого. Вопрос "Какая версия ПО установлена?" уже может быть
задан, а вот ответ на него не всегда очевиден. И наконец третий
подход --- *дистрибутив*.

Большие и маленькие дистрибутивы
--------------------------------

В своём классическом виде дистрибутив --- это дистрибутив ОС, который
складывается из набора пакетов и инсталлятора --- программы для
установки подмножества этих пакетов на целевую систему и их
настройки. К дистрибутиву ОС предъявляются достаточно  серьёзные
требования: множество пакетов должно быть замкнуто по зависимостям
(т.е. никакой пакет дистрибутива не должен требовать для своей работы
пакетов за его пределами), а инсталлятор --- способным работать на
широком спектре оборудования.

Важной особенностью дистрибутива является также его
формальное единство: каждый дистрибутив связан с вполне определённым
сетевым источником (URL) или носителем информации (CD/DVD/flash),
имеет дату выпуска, собственный номер версии и, как правило, кодовое
имя. Благодаря этому свойству, дистрибутивный подход находит
применение не только по отношению к большим и сверхбольшим программным
комплексам, но также оказывается крайне полезен для поставки и
сопровождения сравнительно небольших по размеру систем прикладного
ПО. В отличие от дистрибутивов ОС, дистрибутивы прикладного ПО,
конечно же, не обладают в полной мере свойством замкнутости: напротив,
входящие в них программы по обыкновению требуют для своей работы
определённых компонентов ОС, предоставляемых пакетами базового
дистрибутива. Из-за этой особенности такие дистрибутивы получили
название дополнительных репозиториев или репозиториев-оверлеев.

Приведём несколько примеров. Собственно термин "оверлей", по-видимому,
происходит из Gentoo (а возможно, и FreeBSD), где оверлей является
стандартным и доступным для пользователя механизмом расширения набора
ПО, доступного для сборки и установки[^2]. Другим примером являются
персональные репозитории пакетов (PPA) в Ubuntu Linux[^3]. Полный
цикл упаковки и последующего развёртывания дистрибутива ОС с целевым
набором дополнительного ПО предоставляет система Docker[^4] --- яркий
пример применения дистрибутивного подхода к проблеме поставки и
сопровождения целевого ПО (программного продукта).

Достаточно часто средства для организации дистрибутивов-оверлеев с
целевым ПО, предоставляемые публично как услуга, являются также
средствами сборки с непрерывной интеграцией ПО, т.е. осуществляют
регулярную пересборку, формальное и синтетическое тестирование
целевого ПО по мере его разработки. Примерами таких публичных систем
являются широко известная Suse Open Build Service (OBS)[^5] и менее
известная GearRepo[^6] от сообщества ALT Linux Team.

Слово "карман" для обозначения подобного репозитория-оверлея принято в
рамках проекта Sisyphus[^7]. Правда там со словом "карманы" связывают
прежде всего публичный сервис для сборки и публикации репозиториев,
нежели сами репозитории-оверлеи как таковые. В отличие от сизифовых
карманов, настоящий проект --- Pocket --- прежде всего ориентируется
на конечного пользователя, на распределённую, а не на централизованную
серверную инфраструктуру. Соответственно, слово "карман" ассоциируется
у автора с лекговесностью, простотой использования и переносимостью ПО
для сборки и публикации небольших репозиториев.

Литература
----------

[^1]: *Виталий Липатов*, Korinf: трудности на пути к универсальной
сборочной системе. [Протва--2012](http://www.altlinux.ru/media/protva-2012.pdf).
[^2]: <http://wiki.gentoo.org/wiki/Overlay>
[^3]: <https://help.launchpad.net/Packaging/PPA>
[^4]: <https://docs.docker.com/>
[^5]: <https://ru.opensuse.org/Portal:Служба_сборки>. См. также
"Open Build Service --- создаём свои репозитории" на сайте
[habrahabr.ru](http://habrahabr.ru/post/160609/).
[^6]: <http://www.altlinux.org/GearRepo>
[^7]: <http://www.altlinux.org/Pockets>
